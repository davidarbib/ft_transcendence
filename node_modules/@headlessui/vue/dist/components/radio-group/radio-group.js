import{Fragment as j,computed as p,defineComponent as S,h as T,inject as H,onMounted as K,onUnmounted as M,provide as N,ref as O,toRaw as b}from"vue";import{dom as V}from"../../utils/dom.js";import{Keys as R}from"../../keyboard.js";import{focusIn as A,Focus as y,FocusResult as D,sortByDomNode as $}from"../../utils/focus-management.js";import{useId as L}from"../../hooks/use-id.js";import{compact as U,omit as _,render as F}from"../../utils/render.js";import{Label as W,useLabels as C}from"../label/label.js";import{Description as J,useDescriptions as x}from"../description/description.js";import{useTreeWalker as q}from"../../hooks/use-tree-walker.js";import{VisuallyHidden as z}from"../../internal/visually-hidden.js";import{attemptSubmit as Q,objectToFormEntries as X}from"../../utils/form.js";import{getOwnerDocument as G}from"../../utils/owner.js";let I=Symbol("RadioGroupContext");function P(i){let v=H(I,null);if(v===null){let n=new Error(`<${i} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,P),n}return v}let me=S({name:"RadioGroup",emits:{"update:modelValue":i=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]},name:{type:String,optional:!0}},inheritAttrs:!1,setup(i,{emit:v,attrs:n,slots:h,expose:s}){let u=O(null),o=O([]),E=C({name:"RadioGroupLabel"}),m=x({name:"RadioGroupDescription"});s({el:u,$el:u});let g=p(()=>i.modelValue),f={options:o,value:g,disabled:p(()=>i.disabled),firstOption:p(()=>o.value.find(e=>!e.propsRef.disabled)),containsCheckedOption:p(()=>o.value.some(e=>b(e.propsRef.value)===b(i.modelValue))),change(e){var t;if(i.disabled||g.value===e)return!1;let r=(t=o.value.find(l=>b(l.propsRef.value)===b(e)))==null?void 0:t.propsRef;return r!=null&&r.disabled?!1:(v("update:modelValue",e),!0)},registerOption(e){o.value.push(e),o.value=$(o.value,r=>r.element)},unregisterOption(e){let r=o.value.findIndex(t=>t.id===e);r!==-1&&o.value.splice(r,1)}};N(I,f),q({container:p(()=>V(u)),accept(e){return e.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(e){e.setAttribute("role","none")}});function k(e){if(!u.value||!u.value.contains(e.target))return;let r=o.value.filter(t=>t.propsRef.disabled===!1).map(t=>t.element);switch(e.key){case R.Enter:Q(e.currentTarget);break;case R.ArrowLeft:case R.ArrowUp:if(e.preventDefault(),e.stopPropagation(),A(r,y.Previous|y.WrapAround)===D.Success){let l=o.value.find(d=>{var a;return d.element===((a=G(u))==null?void 0:a.activeElement)});l&&f.change(l.propsRef.value)}break;case R.ArrowRight:case R.ArrowDown:if(e.preventDefault(),e.stopPropagation(),A(r,y.Next|y.WrapAround)===D.Success){let l=o.value.find(d=>{var a;return d.element===((a=G(d.element))==null?void 0:a.activeElement)});l&&f.change(l.propsRef.value)}break;case R.Space:{e.preventDefault(),e.stopPropagation();let t=o.value.find(l=>{var d;return l.element===((d=G(l.element))==null?void 0:d.activeElement)});t&&f.change(t.propsRef.value)}break}}let c=`headlessui-radiogroup-${L()}`;return()=>{let{modelValue:e,disabled:r,name:t,...l}=i,d={ref:u,id:c,role:"radiogroup","aria-labelledby":E.value,"aria-describedby":m.value,onKeydown:k};return T(j,[...t!=null&&e!=null?X({[t]:e}).map(([a,w])=>T(z,U({key:a,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:a,value:w}))):[],F({props:{...n,...l,...d},slot:{},attrs:n,slots:h,name:"RadioGroup"})])}}});var Y=(n=>(n[n.Empty=1]="Empty",n[n.Active=2]="Active",n))(Y||{});let ve=S({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(i,{attrs:v,slots:n,expose:h}){let s=P("RadioGroupOption"),u=`headlessui-radiogroup-option-${L()}`,o=C({name:"RadioGroupLabel"}),E=x({name:"RadioGroupDescription"}),m=O(null),g=p(()=>({value:i.value,disabled:i.disabled})),f=O(1);h({el:m,$el:m}),K(()=>s.registerOption({id:u,element:m,propsRef:g})),M(()=>s.unregisterOption(u));let k=p(()=>{var a;return((a=s.firstOption.value)==null?void 0:a.id)===u}),c=p(()=>s.disabled.value||i.disabled),e=p(()=>b(s.value.value)===b(i.value)),r=p(()=>c.value?-1:e.value||!s.containsCheckedOption.value&&k.value?0:-1);function t(){var a;!s.change(i.value)||(f.value|=2,(a=m.value)==null||a.focus())}function l(){f.value|=2}function d(){f.value&=-3}return()=>{let a=_(i,["value","disabled"]),w={checked:e.value,disabled:c.value,active:Boolean(f.value&2)},B={id:u,ref:m,role:"radio","aria-checked":e.value?"true":"false","aria-labelledby":o.value,"aria-describedby":E.value,"aria-disabled":c.value?!0:void 0,tabIndex:r.value,onClick:c.value?void 0:t,onFocus:c.value?void 0:l,onBlur:c.value?void 0:d};return F({props:{...a,...B},slot:w,attrs:v,slots:n,name:"RadioGroupOption"})}}}),be=W,Re=J;export{me as RadioGroup,Re as RadioGroupDescription,be as RadioGroupLabel,ve as RadioGroupOption};
